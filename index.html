<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Xenia Services API</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<script>
async function fetchServices() {
  const resp = await fetch('urls.json');
  return await resp.json();
}

function getServiceFromURL() {
  // ?services=test
  const urlParams = new URLSearchParams(window.location.search);
  let key = urlParams.get('services');
  if (key) return key;

  // /services/test
  const pathMatch = window.location.pathname.match(/\/services\/([^\/]+)/);
  if (pathMatch) return pathMatch[1];

  return null;
}

async function main() {
  const key = getServiceFromURL();
  const services = await fetchServices();

  if (!key) {
    document.body.innerHTML = `<h2>Specify service as ?services=NAME or navigate to /services/NAME</h2>`;
    return;
  }

  let result = {};
  if (services[key]) {
    result[key] = services[key];
  } else {
    result[key] = services["default"];
  }

  document.body.innerHTML = `<pre>${JSON.stringify(result, null, 2)}</pre>`;
}
main();
</script>
</body>
</html>
